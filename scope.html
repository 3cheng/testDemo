<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>
            作用域理解
        </title>

    </head>
    
    <body>
        <h3>作用域理解</h3>
        <!-- 测试按钮 -->
        <button id='btn1'>按钮1</button>
        <button id='btn2'>按钮2</button>
        <button id='btn3'>按钮3</button>
        <button id='btn4'>按钮4</button>
        <button id='btn5'>按钮5</button>
        <script>
          
          // 后面函数也能调用
          // scopeVar();
          function scopeVar(){
            alert(a);  //undefined
            var a = 0;
            a++;
            alert(a); // 1
          }

          // 2. this 工作原理 5种情况：
          // 2.1 全局范围 this : window
          // 2.2 函数调用 foo() : window
          // 2.3 方法调用 test.foo() : test
          // 2.4 构造函数调用 new foo(): 新的实例
          // 2.5 显式设置this apply call方法 : 参数1

          // 笔试题1
          function test1(){
            var a_obj = {
              a: 1,
              aFun: function(){
                alert(this.a); 
              }
            }
            var b = a_obj.aFun;
            // 2.2 函数调用
            b(); // undefined
            // 2.3 方法调用
            a_obj.aFun(); // 1
          }
          // test1();

          //循环里创建函数 
          window.onload = function(){
            // 循环按钮
            var btns = document.getElementsByTagName('button');
            var btn = null;
            for(var i = 0, len = btns.length; i < len; i++){
              btn = btns[i];
              btn.onclick = function(){
                btn.style.background = 'blue'; //btn 永远为 btns[len -1]即最后一个按钮
                console.log(i);// len 即 5
                this.style.background = 'red';// this 为当前点击的按钮

              }
            }
          }

          // 笔试题2
          var name = "The Window";
          function test2(){
            var object = {
              name : "My Object",
              getNameFunc : function(){
                  alert('1.' + this.name);
                  return function(){
                      return this.name;
                  };
              }
            };
            var func = object.getNameFunc(); // 1. My Object
            alert('2.' + func()); // 2. The Window
            alert('3.' + func.call(object)); //3. My Object 
            alert('4.' + func.apply(object)); //4. My Object
          }
          test2();

        </script>

    </body>
</html>